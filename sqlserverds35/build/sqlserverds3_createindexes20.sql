USE DS3
GO

ALTER TABLE CATEGORIES20 ADD CONSTRAINT PK_CATEGORIES20 PRIMARY KEY CLUSTERED 
  (
  CATEGORY
  )  
  ON DS_MISC_FG 
GO

ALTER TABLE CUSTOMERS20 ADD CONSTRAINT PK_CUSTOMERS20 PRIMARY KEY CLUSTERED 
  (
  CUSTOMERID
  )  
  ON DS_CUST_FG 
GO

CREATE UNIQUE INDEX IX_CUST_UN_PW20 ON CUSTOMERS20 
  (
  USERNAME, 
  PASSWORD
  )
  ON DS_IND_FG
GO

CREATE INDEX IX_CUST_HIST_CUSTOMERID20 ON CUST_HIST20
  (
  CUSTOMERID
  )
  ON DS_IND_FG
GO

CREATE INDEX IX_CUST_HIST_CUSTOMERID_PRODID20 ON CUST_HIST20 
  (
  CUSTOMERID ASC,
  PROD_ID ASC
  )
  ON DS_IND_FG
GO

ALTER TABLE CUST_HIST20
  ADD CONSTRAINT FK_CUST_HIST_CUSTOMERID20 FOREIGN KEY (CUSTOMERID)
  REFERENCES CUSTOMERS20 (CUSTOMERID)
  ON DELETE CASCADE
GO

ALTER TABLE ORDERS20 ADD CONSTRAINT PK_ORDERS20 PRIMARY KEY CLUSTERED 
  (
  ORDERID
  )  
  ON DS_ORDERS_FG 
GO

CREATE INDEX IX_ORDER_CUSTID20 ON ORDERS20
  (
  CUSTOMERID
  )
  ON DS_IND_FG
GO

ALTER TABLE ORDERLINES20 ADD CONSTRAINT PK_ORDERLINES20 PRIMARY KEY CLUSTERED 
  (
  ORDERID,
  ORDERLINEID
  )  
  ON DS_ORDERS_FG 
GO

ALTER TABLE ORDERLINES20 ADD CONSTRAINT FK_ORDERID20 FOREIGN KEY (ORDERID)
  REFERENCES ORDERS20 (ORDERID)
  ON DELETE CASCADE
GO

ALTER TABLE INVENTORY20 ADD CONSTRAINT PK_INVENTORY20 PRIMARY KEY CLUSTERED 
  (
  PROD_ID
  )  
  ON DS_MISC_FG 
GO

ALTER TABLE PRODUCTS20 ADD CONSTRAINT PK_PRODUCTS20 PRIMARY KEY CLUSTERED 
  (
  PROD_ID
  )  
  ON DS_MISC_FG 
GO

CREATE INDEX IX_PROD_PRODID20 ON PRODUCTS20 
  (
  PROD_ID ASC
  )
  INCLUDE (TITLE)
  ON DS_IND_FG
GO

CREATE INDEX IX_PROD_PRODID_COMMON_PRODID20 ON PRODUCTS20
  (
  PROD_ID ASC,
  COMMON_PROD_ID ASC
  )
  INCLUDE (TITLE, ACTOR)
  ON DS_IND_FG
GO

CREATE INDEX IX_PROD_SPECIAL_CATEGORY_PRODID20 ON PRODUCTS20 
  (
  SPECIAL ASC,
  CATEGORY ASC,
  PROD_ID ASC
  )
  INCLUDE (TITLE, ACTOR, PRICE, COMMON_PROD_ID)
  ON DS_IND_FG
GO

CREATE FULLTEXT CATALOG FULLTEXT_DSPROD20 ON FILEGROUP DS_FULLTEXT_FG;
GO
CREATE FULLTEXT INDEX ON PRODUCTS20
	( 
	ACTOR,
	TITLE
	)
	KEY INDEX PK_PRODUCTS20 
	ON FULLTEXT_DSPROD20;
GO

CREATE INDEX IX_PROD_CATEGORY20 ON PRODUCTS20 
  (
  CATEGORY
  )
  ON DS_IND_FG
GO

CREATE INDEX IX_PROD_SPECIAL20 ON PRODUCTS20
  (
  SPECIAL
  )
  ON DS_IND_FG
GO

CREATE INDEX IX_PROD_MEMBERSHIP20 ON PRODUCTS20
  (
  MEMBERSHIP_ITEM
  )
  ON DS_IND_FG
GO

CREATE INDEX IX_INV_PROD_ID20 on INVENTORY20
  (
  PROD_ID
  )
  ON DS_IND_FG
GO

ALTER TABLE MEMBERSHIP20 ADD CONSTRAINT PK_MEMBERSHIP20 PRIMARY KEY CLUSTERED 
  (
  CUSTOMERID
  )  
  ON DS_IND_FG 
GO

ALTER TABLE MEMBERSHIP20
  ADD CONSTRAINT FK_MEMBERSHIP_CUSTID20 FOREIGN KEY (CUSTOMERID)
  REFERENCES CUSTOMERS20 (CUSTOMERID)
  ON DELETE CASCADE
GO

ALTER TABLE REVIEWS20 ADD CONSTRAINT PK_REVIEWS20 PRIMARY KEY CLUSTERED 
  (
  REVIEW_ID
  )  
  ON DS_REVIEW_FG 
GO

ALTER TABLE REVIEWS20
  ADD CONSTRAINT FK_REVIEWS_PROD_ID20 FOREIGN KEY (PROD_ID)
  REFERENCES PRODUCTS20 (PROD_ID)
  ON DELETE CASCADE
GO

ALTER TABLE REVIEWS20
  ADD CONSTRAINT FK_REVIEWS_CUSTOMERID20 FOREIGN KEY (CUSTOMERID)
  REFERENCES CUSTOMERS20 (CUSTOMERID)
  ON DELETE CASCADE
GO

CREATE INDEX IX_REVIEWS_PROD_ID20 ON REVIEWS20
  (
  PROD_ID
  )
  ON DS_IND_FG
GO

CREATE INDEX IX_REVIEWS_STARS20 ON REVIEWS20
  (
  STARS
  )
  ON DS_IND_FG
GO

CREATE INDEX IX_REVIEWS_PRODSTARS20 ON REVIEWS20
  (
  PROD_ID,STARS
  )
  ON DS_IND_FG
GO

ALTER TABLE REVIEWS_HELPFULNESS20 ADD CONSTRAINT PK_REVIEWS_HELPFULNESS20 PRIMARY KEY CLUSTERED 
  (
  REVIEW_HELPFULNESS_ID
  )  
  ON DS_REVIEW_FG 
GO

ALTER TABLE REVIEWS_HELPFULNESS20
  ADD CONSTRAINT FK_REVIEW_ID20 FOREIGN KEY (REVIEW_ID)
  REFERENCES REVIEWS20 (REVIEW_ID)
  ON DELETE CASCADE
GO

CREATE INDEX IX_REVIEWS_HELP_REVID20 ON REVIEWS_HELPFULNESS20
  (
  REVIEW_ID
  )
  ON DS_IND_FG
GO

CREATE INDEX IX_REVIEWS_HELP_CUSTID20 ON REVIEWS_HELPFULNESS20
  (
  CUSTOMERID
  )
  ON DS_IND_FG
GO

CREATE INDEX IX_REORDER_PRODID20 ON REORDER20
  (
  PROD_ID
  )
  ON DS_IND_FG
GO

CREATE NONCLUSTERED INDEX IX_REVIEWS_PRODID_REVID_DATE20 ON REVIEWS20
  (
  PROD_ID ASC,
  REVIEW_ID ASC,
  REVIEW_DATE ASC
  )
  INCLUDE (STARS,CUSTOMERID,REVIEW_SUMMARY,REVIEW_TEXT)
  WITH (SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF)
  ON DS_IND_FG
go

CREATE NONCLUSTERED INDEX IX_REVIEWSHELPFULNESS_ID_HELPID20 ON [dbo].[REVIEWS_HELPFULNESS20]
  (
  REVIEW_ID ASC,
  REVIEW_HELPFULNESS_ID ASC
  )
  INCLUDE (HELPFULNESS)
  WITH (SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF)
  ON DS_IND_FG
go



CREATE STATISTICS stat_cust_cctype_username20 ON CUSTOMERS20(CREDITCARDTYPE, USERNAME)
GO
CREATE STATISTICS stat_cust_cctype_customerid20 ON CUSTOMERS20(CREDITCARDTYPE, CUSTOMERID)
GO
CREATE STATISTICS stat_prod_prodid_special20 ON PRODUCTS20(PROD_ID, SPECIAL)
GO
CREATE STATISTICS stat_prod_category_prodid20 ON PRODUCTS20(CATEGORY, PROD_ID)
GO
CREATE STATISTICS stat_reviews_reviewid_stars20 ON REVIEWS20(REVIEW_ID, STARS)
GO
CREATE STATISTICS stat_reviews_prodid_custid20 ON REVIEWS20(PROD_ID, CUSTOMERID)
GO
CREATE STATISTICS stat_reviews_reviewid_date20 ON REVIEWS20(REVIEW_ID, REVIEW_DATE)
GO
CREATE STATISTICS stat_reviews_date_prodid20 ON REVIEWS20(REVIEW_DATE, PROD_ID)
GO
CREATE STATISTICS stat_reviews_prodid_stars_reviewid20 ON REVIEWS20(PROD_ID, STARS, REVIEW_ID)
GO
  
