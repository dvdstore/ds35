-- Tables
\c ds3;

CREATE UNIQUE INDEX IX_CUST_USERNAME10 ON CUSTOMERS10
  (
  USERNAME
  );

CREATE UNIQUE INDEX IX_CUST_USER_PASSWORD10 ON CUSTOMERS10
  (
  USERNAME,
  PASSWORD
  );

CREATE INDEX IX_CUST_HIST_CUSTOMERID10 ON CUST_HIST10
  (
  CUSTOMERID
  );

ALTER TABLE CUST_HIST10
  ADD CONSTRAINT FK_CUST_HIST_CUSTOMERID10 FOREIGN KEY (CUSTOMERID)
  REFERENCES CUSTOMERS10 (CUSTOMERID)
  ON DELETE CASCADE
  ;

CREATE INDEX IX_ORDER_CUSTID10 ON ORDERS10
  (
  CUSTOMERID
  );

ALTER TABLE ORDERS10
  ADD CONSTRAINT FK_CUSTOMERID10 FOREIGN KEY (CUSTOMERID)
  REFERENCES CUSTOMERS10 (CUSTOMERID)
  ON DELETE SET NULL
  ;

CREATE UNIQUE INDEX IX_ORDERLINES_ORDERID10 ON ORDERLINES10
  (
  ORDERID, ORDERLINEID
  );

ALTER TABLE ORDERLINES10
  ADD CONSTRAINT FK_ORDERID10 FOREIGN KEY (ORDERID)
  REFERENCES ORDERS10 (ORDERID)
  ON DELETE CASCADE
  ;

CREATE INDEX IX_PROD_ACTOR10 ON PRODUCTS10
USING GIN
  (
  to_tsvector('simple',ACTOR)
  );

CREATE INDEX IX_PROD_CATEGORY10 ON PRODUCTS10
  (
  CATEGORY
  );

CREATE INDEX IX_PROD_TITLE10 ON PRODUCTS10
USING GIN
  (
   to_tsvector('simple',TITLE)
  );

CREATE INDEX IX_PROD_SPECIAL10 ON PRODUCTS10
  (
  SPECIAL
  );

CREATE INDEX IX_PROD_CAT_SPECIAL10 ON PRODUCTS10
  (
  CATEGORY,
  SPECIAL
  );

CREATE INDEX IX_PROD_MEMBERSHIP10 ON PRODUCTS10
  (
  MEMBERSHIP_ITEM
  )
  ;

CREATE INDEX IX_INV_PROD_ID10 ON INVENTORY10
  (
  PROD_ID
  )
  ;

ALTER TABLE MEMBERSHIP10
  ADD CONSTRAINT FK_MEMBERSHIP_CUSTID10 FOREIGN KEY (CUSTOMERID)
  REFERENCES CUSTOMERS10 (CUSTOMERID)
  ON DELETE CASCADE
  ;

ALTER TABLE REVIEWS10
  ADD CONSTRAINT FK_PROD_ID10 FOREIGN KEY (PROD_ID)
  REFERENCES PRODUCTS10 (PROD_ID)
  ON DELETE CASCADE
  ;

ALTER TABLE REVIEWS10
  ADD CONSTRAINT FK_REVIEW_CUSTOMERID10 FOREIGN KEY (CUSTOMERID)
  REFERENCES CUSTOMERS10 (CUSTOMERID)
  ON DELETE CASCADE
  ;

CREATE INDEX IX_REVIEWS_PROD_ID10 ON REVIEWS10
  (
  PROD_ID
  )
  ;

CREATE INDEX IX_REVIEWS_STARS10 ON REVIEWS10
  (
  STARS
  )
  ;

CREATE INDEX IX_REVIEWS_PRODSTARS10 ON REVIEWS10
  (
  PROD_ID,STARS
  )
  ;

ALTER TABLE REVIEWS_HELPFULNESS10
  ADD CONSTRAINT FK_REVIEW_ID10 FOREIGN KEY (REVIEW_ID)
    REFERENCES REVIEWS10 (REVIEW_ID)
        ON DELETE CASCADE
  ;

CREATE INDEX IX_REVIEWS_HELP_REVID10 ON REVIEWS_HELPFULNESS10
  (
  REVIEW_ID
  )
  ;

CREATE INDEX IX_REVIEWS_HELP_CUSTID10 ON REVIEWS_HELPFULNESS10
  (
  CUSTOMERID
  )
  ;

CREATE INDEX IX_REORDER_PRODID10 ON REORDER10
  (
  PROD_ID
  )
  ;


