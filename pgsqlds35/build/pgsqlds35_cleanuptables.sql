-- Clean up Tables
\c ds3;

alter table CUSTOMERS1 DISABLE TRIGGER ALL;
alter table ORDERS1 DISABLE TRIGGER ALL;
alter table ORDERLINES1 DISABLE TRIGGER ALL;
alter table CUST_HIST1 DISABLE TRIGGER ALL;
alter table REVIEWS1 DISABLE TRIGGER ALL;
alter table REVIEWS_HELPFULNESS1 DISABLE TRIGGER ALL;
alter table MEMBERSHIP1 DISABLE TRIGGER ALL;

delete from CUSTOMERS1 where CUSTOMERID > 2000000;
delete from ORDERS1 where ORDERID > 1200000;
delete from ORDERLINES1 where ORDERID > 1200000;
delete from CUST_HIST1 where ORDERID > 1200000;
delete from REVIEWS1 where REVIEW_ID > 2000000;
delete from REVIEWS_HELPFULNESS1 where REVIEW_HELPFULNESS_ID > 2000000;
delete from MEMBERSHIP1 where CUSTOMERID > 200000;

alter table CUST_HIST1 ENABLE TRIGGER ALL;
alter table ORDERLINES1 ENABLE TRIGGER ALL;
alter table ORDERS1 ENABLE TRIGGER ALL;
alter table CUSTOMERS1 ENABLE TRIGGER ALL;
alter table REVIEWS1 ENABLE TRIGGER ALL;
alter table REVIEWS_HELPFULNESS1 ENABLE TRIGGER ALL;
alter table MEMBERSHIP1 ENABLE TRIGGER ALL;

drop table INVENTORY1;

CREATE TABLE INVENTORY1
  (
  PROD_ID INT NOT NULL PRIMARY KEY,
  QUAN_IN_STOCK INT NOT NULL,
  SALES INT NOT NULL
  )
  ;

alter table INVENTORY1 DISABLE TRIGGER ALL;

\copy INVENTORY1 FROM '../../data_files/prod/inv.csv' DELIMITER ',' CSV

alter table INVENTORY1 ENABLE TRIGGER ALL;

GRANT ALL PRIVILEGES on INVENTORY1 to ds3;

